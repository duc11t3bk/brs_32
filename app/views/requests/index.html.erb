<% provide :title, t("requests.index.title") %>
<div id="books">
  <div class="div-search">
    <div class="row">
      <div class="col-lg-12">
        <%= search_form_for @search, url: user_requests_path do |f| %>
          <div class="col-lg-offset-2 col-lg-8">
            <%= f.search_field :book_title_cont, class: "form-control" %>
          </div>
          <div class="col-lg-2 padding-0">
            <%= f.button type: "submit", class: "btn btn-default max-width" do %>
              <span class="glyphicon glyphicon-search"></span>
              <%= t "requests.index.btn_search" %>
            <% end %>
          </div>
        <% end %>
      </div>
    </div>
  </div>
  <div class="row padding-top-50">
    <div class="col-lg-12">
      <table class="table table-bordered book-table">
        <thead>
          <tr>
            <th class="width-10"><%= t "requests.index.numbers" %></th>
            <th class="width-20"><%= t "requests.index.user_name" %></th>
            <th class="width-30"><%= t "requests.index.book_title" %></th>
            <th class="width-20"><%= t "requests.index.created_at" %></th>
            <th class="width-10"><%= t "requests.index.status" %></th>
            <th class="width-10"><%= t "requests.index.cancel"  %></th>
          </tr>
        </thead>
        <tbody>
          <% @requests.each_with_index do |request, index| %>
            <tr>
              <td><%= increase_one index %></td>
              <td><%= request.user.name %></td>
              <td><%= request.book.title %></td>
              <td><%= request.created_at %></td>
              <td class="text-center status">
                <% if request.status == Settings.requests.status[:waiting] %>
                <span class="btn btn-warning width-80">
                  <%= request.status %>
                </span>
                <% elsif request.status == Settings.requests.status[:approved] %>
                <span class="btn btn-success width-80">
                  <%= request.status %>
                </span>
                <% elsif request.status == Settings.requests.status[:rejected] %>
                <span class="btn btn-danger width-80">
                  <%= request.status %>
                </span>
                <% end %>
              </td>
              <td class="text-center">
                <%= link_to user_request_path(current_user.id, request),
                  method: :delete,
                  data: {confirm: t("requests.index.confirm_delete")},
                  class: "btn btn-danger font-size-15 max-width" do %>
                  <span class="glyphicon glyphicon-trash"></span>
                <% end %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
</div>

